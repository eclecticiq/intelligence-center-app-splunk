<form version="1.1">
  <label>Observables DB Info</label>
  <search id="base1">
    <query>`observables_index`
          | fields id, type ,_time, meta.maliciousness, created_at,last_updated_at,entities{} , value 
          | fields - _raw 
          | rex field="entities{}" "\/(?&lt;entity_id&gt;(\w+|\-)+$)" 
          | mvexpand entity_id 
          | dedup id entity_id
          | join entity_id type=left max=0 [search `entity_index`|eval meta_tags=  case(isnull('meta.tags{}'), "N/A",'meta.tags{}'="", "N/A", 1=1, 'meta.tags{}') | fields id, meta_tags,outgoing_feeds| fields - _raw |mvexpand meta_tags| dedup id, meta_tags, outgoing_feeds | rename id as entity_id | table entity_id outgoing_feeds meta_tags]|table id, outgoing_feeds, meta_tags, type ,_time, meta.maliciousness, created_at,last_updated_at, entity_id, value | eval meta_tags=  case(isnull(meta_tags), "N/A",meta_tags="", "N/A", 1=1, meta_tags) | eval outgoing_feeds = case(isnull(outgoing_feeds), "N/A",outgoing_feeds="", "N/A", 1=1, outgoing_feeds) | search $token_meta$ | search $feed_token$ 
    </query>
    <earliest>$field1.earliest$</earliest>
    <latest>$field1.latest$</latest>
  </search>
  <fieldset submitButton="false">
    <input type="time" token="field1">
      <label>Time Range</label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
    <input type="dropdown" token="feed_token">
      <label>Select feed</label>
      <choice value="*">All</choice>
      <prefix>outgoing_feeds="</prefix>
      <suffix>"</suffix>
      <fieldForLabel>outgoing_feeds</fieldForLabel>
      <fieldForValue>outgoing_feeds</fieldForValue>
      <search>
        <query>`entity_index`| dedup outgoing_feeds | table outgoing_feeds</query>
        <earliest>0</earliest>
        <latest></latest>
      </search>
      <default>*</default>
      <initialValue>*</initialValue>
    </input>
    <input type="multiselect" token="token_meta">
      <label>Tags</label>
      <fieldForLabel>tags</fieldForLabel>
      <fieldForValue>tags</fieldForValue>
      <search>
        <query>`entity_index`| mvexpand meta.tags{}| dedup meta.tags{} |eval tags= case(isnull('meta.tags{}'), "N/A",'meta.tags{}'="", "N/A", 1=1, 'meta.tags{}') |  table tags</query>
        <earliest>0</earliest>
        <latest></latest>
      </search>
      <delimiter> OR </delimiter>
      <choice value="*">All</choice>
      <prefix>meta_tags="</prefix>
      <suffix>"</suffix>
      <default>*</default>
    </input>
  </fieldset>
  <row>
    <panel>
      <title>Total Count of Observables in Splunk</title>
      <single>
        <search base="base1">
          <query>| stats distinct_count(id)</query>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x65a637","0x65a637"]</option>
        <option name="rangeValues">[0]</option>
        <option name="refresh.display">progressbar</option>
        <option name="showSparkline">1</option>
        <option name="showTrendIndicator">1</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
        <option name="trendColorInterpretation">standard</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="unitPosition">after</option>
        <option name="useColors">1</option>
        <option name="useThousandSeparators">0</option>
      </single>
    </panel>
    <panel>
      <title>Observables Distribution</title>
      <table>
        <search base="base1">
          <query>
            | stats distinct_count(id) as Count by type
          </query>
        </search>
        <option name="count">10</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="totalsRow">false</option>
        <format type="color" field="Update Strategy">
          <colorPalette type="map">{"N/A - this feed isn't mentioned in settings":#F8BE34}</colorPalette>
        </format>
        <format type="color" field="Feed Name">
          <colorPalette type="map">{"N/A - this feed isn't mentioned in settings":#F8BE34}</colorPalette>
        </format>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Downloaded Observables by time</title>
      <chart>
        <search base="base1">
          <query>
            | timechart distinct_count(id) as Count by feed_id
          </query>
        </search>
        <option name="charting.chart">column</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
    <panel>
      <title>Downloaded Observables by Time and Type</title>
      <chart>
        <search base="base1">
          <query>
              | timechart distinct_count(id) as Count by type</query>
        </search>
        <option name="charting.chart">column</option>
        <option name="charting.chart.stackMode">stacked</option>
        <option name="charting.drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>Count of Observables by Type</title>
      <chart>
        <search base="base1">
          <query>
              | stats distinct_count(id) as Count by type | sort - Count
          </query>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
      </chart>
      <table id="eiq_table_highlight_00">
        <search base="base1">
          <query>
            | stats distinct_count(id) as "Count" by type
            | sort - Count 
            | rename type as "Observable-Type"
          </query>
        </search>
        <option name="count">20</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="percentagesRow">false</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">false</option>
        <option name="wrap">true</option>
        <drilldown>
          <link target="_blank">search?q=%60observables_index%60%20type%3D$row.Observable-Type$%20%7C%20sort%20-%20last_updated_at%20%7C%20dedup%20id&amp;earliest=$field1.earliest$&amp;latest=$field1.latest$</link>
        </drilldown>
      </table>
    </panel>
    <panel>
      <title>Count of Observables by Tags</title>
      <chart>
        <search base="base1">
          <query>
              | stats distinct_count(id) as Count by meta_tags | sort - Count
          </query>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
      </chart>
      <table id="eiq_table_highlight_02">
        <search base="base1">
          <query>
              | stats distinct_count(id) as "Count" by meta_tags 
              | sort - Count
              | rename meta_tags AS "Tags"
          </query>
        </search>
        <option name="count">20</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="percentagesRow">false</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">false</option>
        <option name="wrap">true</option>
        <drilldown>
          <link target="_blank">search?q=%60observables_index%60%0D%0A%7C%20fields%20id%20entities%7B%7D%20type%20_time%20meta.maliciousness%2C%20created_at%2Clast_updated_at%2C%20value%0D%0A%7C%20rex%20field%3D%22entities%7B%7D%22%20%22%5C%2F(%3F%3Centity_id%3E(%5Cw%2B%7C%5C-)%2B$)%22%20%0D%0A%7C%20mvexpand%20entity_id%20%0D%0A%7C%20dedup%20id%20entity_id%20%0D%0A%7C%20join%20entity_id%20type%3Dleft%20max%3D0%20%0D%0A%20%20%20%20%5B%20search%20%60entity_index%60%20%0D%0A%20%20%20%20%7C%20fields%20id%2C%20meta.tags%7B%7D%2Coutgoing_feeds%7B%7D%20%0D%0A%20%20%20%20%7C%20fields%20-%20_raw%20%0D%0A%20%20%20%20%7C%20rex%20field%3D%22outgoing_feeds%7B%7D%22%20%22%5C%2F(%3F%3Cfeed_id%3E%5Cd%2B)%22%20%0D%0A%20%20%20%20%7C%20mvexpand%20feed_id%20%0D%0A%20%20%20%20%7C%20mvexpand%20meta.tags%7B%7D%20%0D%0A%20%20%20%20%7C%20dedup%20id%2C%20meta.tags%7B%7D%2C%20feed_id%20%0D%0A%20%20%20%20%7C%20rename%20id%20as%20entity_id%20meta.tags%7B%7D%20as%20meta_tags%20%0D%0A%20%20%20%20%7C%20table%20entity_id%20feed_id%20meta_tags%5D%20%0D%0A%7C%20table%20id%2C%20feed_id%2C%20meta_tags%2C%20type%20%2C_time%2C%20meta.maliciousness%2C%20created_at%2Clast_updated_at%2C%20entity_id%2C%20value%0D%0A%7C%20eval%20meta_tags%3D%20%20case(isnull(meta_tags)%2C%20%22N%2FA%22%2Cmeta_tags%3D%22%22%2C%20%22N%2FA%22%2C%201%3D1%2C%20meta_tags)%0D%0A%7C%20stats%20values(meta.maliciousness)%20as%20Confidence%2C%20values(created_at)%20as%20created_at%2C%20values(last_updated_at)%20as%20last_updated_at%2C%20values(entity_id)%20as%20entity_id%2C%20values(type)%20as%20type%20%2Cvalues(value)%20as%20value%2Cvalues(meta_tags)%20as%20meta_tags%20by%20id%0D%0A|search%20meta_tags%3D%22$row.Tags$%22&amp;earliest=$field1.earliest$&amp;latest=$field1.latest$</link>
        </drilldown>
      </table>
    </panel>
    <panel>
      <title>Count of Observables by Confidence</title>
      <chart>
        <search base="base1">
          <query>
              | stats distinct_count(id) as Count by meta.maliciousness
          </query>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="refresh.display">progressbar</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
      </chart>
      <table>
        <search base="base1">
          <query>
            | stats distinct_count(id) as "Count" by meta.maliciousness | eval Confidence=case(isnotnull('meta.maliciousness'),'meta.maliciousness', 'meta.maliciousness'!="",'meta.maliciousness',1=1,"N/A") 
            | sort - Count | fields - meta.maliciousness | table Confidence Count
          </query>
        </search>
        <option name="count">20</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="percentagesRow">false</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">false</option>
        <option name="wrap">true</option>
        <drilldown>
          <link target="_blank">search?q=%60observables_index%60%0A%7C%20search%20meta.maliciousness%3D$row.Confidence$%20%7C%20sort%20-%20last_updated_at%20%7C%20dedup%20id&amp;earliest=$field1.earliest$&amp;latest=$field1.latest$</link>
        </drilldown>
      </table>
    </panel>
  </row>
</form>